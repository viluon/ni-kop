<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Ondřej Kvapil" />
  <title>NI-KOP – úkol 1</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!-- Bootstrap 4.5.0 stylesheet -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <link rel="stylesheet" href="css/mods.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
<!-- <script data-main="scripts/main" src="js/require.js"></script> -->
  <!-- Load React. -->
  <!-- Note: when deploying, replace "development.js" with "production.min.js". -->
<!--  <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script> -->


</head>
<body class="d-flex flex-column">

<nav id="TOC" class="navbar navbar-dark bg-dark">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a href="#" class="ml-5 mr-auto navbar-brand">NI-KOP – úkol 1<br><span style="font-size: smaller"> 
        by <i>Ondřej Kvapil</i></span></a>
<div class="collapse navbar-collapse" id="navbarSupportedContent">
<ul>
<li><a href="#kombinatorická-optimalizace-problém-batohu">Kombinatorická optimalizace: problém batohu</a></li>
</ul>
</div>
</nav>

<!-- <nav class="navbar navbar-dark navbar-expand-md bg-dark mb-4">
<p class="author">Ondřej Kvapil</p>
</nav>
 -->

<main role="main" class="flex-fill"><div class="container my-5">
<h1 id="kombinatorická-optimalizace-problém-batohu">Kombinatorická optimalizace: problém batohu</h1>
<p>První úkol předmětu NI-KOP jsem se rozhodl implementovat v jazyce Rust za pomoci nástrojů na <em>literate programming</em> – přístup k psaní zdrojového kódu, který upřednostňuje lidsky čitelný popis před seznamem příkazů pro počítač. Tento soubor obsahuje veškerý zdrojový kód nutný k reprodukci mojí práce.</p>
<h2 id="instrukce-k-sestavení-programu">Instrukce k sestavení programu</h2>
<p>Program využívá standardních nástrojů jazyka Rust. O sestavení stačí požádat <code>cargo</code>.</p>
<div class="doctest" data-status="SUCCESS">
<div class="doctestInput">
<div class="fold-block">
<button class="btn btn-outline-primary btn-sm fold-toggle" type="button" data-toggle="collapse" data-target="#build-instructions-container" aria-controls="build-instructions-container">&lt;&lt;build-instructions&gt;&gt;=</button>
<div id="build-instructions-container" class="collapse">
<div class="sourceCode" id="build-instructions" style="max-height: 50vh"><pre class="sourceCode zsh eval bootstrap-fold overflow-auto"><code class="sourceCode zsh"><span id="build-instructions-1"><a href="#build-instructions-1" aria-hidden="true" tabindex="-1"></a><span class="kw">cd</span> solver</span>
<span id="build-instructions-2"><a href="#build-instructions-2" aria-hidden="true" tabindex="-1"></a>cargo build --release --color always</span></code></pre></div>
</div>
</div>
</div>
<div class="doctestResult">
<div class="programOutput">
<pre class="ansi2html-content"><span style="font-weight: bold"></span><span style="font-weight: bold; color: #00aa00"> Downloading</span> crates ...
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #00aa00">  Downloaded</span> anyhow v1.0.44
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #00aa00">   Compiling</span> anyhow v1.0.44
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #00aa00">   Compiling</span> solver v0.1.0 (/__w/ni-kop/ni-kop/1-exact-knapsack/solver)
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">warning</span><span style="font-weight: bold">: unused variable: `b`</span>
  <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">--&gt; </span>src/main.rs:85:17
   <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">|</span>
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">85</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>        let (m, b, items) = (self.m, self.b, &amp;self.items);
   <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>                <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">^</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">help: if this is intentional, prefix it with an underscore: `_b`</span>
   <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">|</span>
   <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">= </span><span style="font-weight: bold">note</span>: `#[warn(unused_variables)]` on by default

<span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">warning</span><span style="font-weight: bold">: unused variable: `b`</span>
   <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">--&gt; </span>src/main.rs:112:17
    <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">|</span>
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">112</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>        let (m, b, items) = (self.m, self.b, &amp;self.items);
    <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>                <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">^</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">help: if this is intentional, prefix it with an underscore: `_b`</span>

<span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">warning</span><span style="font-weight: bold">: unused variable: `prices`</span>
   <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">--&gt; </span>src/main.rs:113:13
    <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">|</span>
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">113</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>        let prices: Vec&lt;u32&gt; = items.iter().rev()
    <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>            <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">^^^^^^</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">help: if this is intentional, prefix it with an underscore: `_prices`</span>

<span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">warning</span><span style="font-weight: bold">: unused variable: `b`</span>
   <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">--&gt; </span>src/main.rs:141:17
    <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">|</span>
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">141</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>        let (m, b, items) = (self.m, self.b, &amp;self.items);
    <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>                <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">^</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">help: if this is intentional, prefix it with an underscore: `_b`</span>

<span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">warning</span><span style="font-weight: bold">: field is never read: `id`</span>
 <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">--&gt; </span>src/main.rs:8:5
  <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">|</span>
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">8</span> <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>    id: i32, m: u32, b: u32, items: Vec&lt;(u32, u32)&gt;
  <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">| </span>    <span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">^^^^^^^</span>
  <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">|</span>
  <span style="font-weight: bold"></span><span style="font-weight: bold; color: #5c5cff">= </span><span style="font-weight: bold">note</span>: `#[warn(dead_code)]` on by default

<span style="font-weight: bold"></span><span style="font-weight: bold; color: #aa5500">warning</span><span style="font-weight: bold">:</span> `solver` (bin "solver") generated 5 warnings
<span style="font-weight: bold"></span><span style="font-weight: bold; color: #00aa00">    Finished</span> release [optimized] target(s) in 3.91s
</pre>
</div>
</div>
</div>
<h2 id="benchmarking">Benchmarking</h2>
<p>Pro provedení měření výkonu programu jsem využil nástroje Hyperfine.</p>
<div class="doctest" data-status="SUCCESS">
<div class="doctestInput">
<div class="fold-block">
<button class="btn btn-outline-primary btn-sm fold-toggle" type="button" data-toggle="collapse" data-target="#benchmark-container" aria-controls="benchmark-container">&lt;&lt;benchmark&gt;&gt;=</button>
<div id="benchmark-container" class="collapse">
<div class="sourceCode" id="benchmark" style="max-height: 50vh"><pre class="sourceCode zsh eval bootstrap-fold overflow-auto"><code class="sourceCode zsh"><span id="benchmark-1"><a href="#benchmark-1" aria-hidden="true" tabindex="-1"></a>uname -a</span>
<span id="benchmark-2"><a href="#benchmark-2" aria-hidden="true" tabindex="-1"></a><span class="kw">cd</span> solver</span>
<span id="benchmark-3"><a href="#benchmark-3" aria-hidden="true" tabindex="-1"></a>hyperfine --export-json ../docs/bench.json <span class="kw">\</span></span>
<span id="benchmark-4"><a href="#benchmark-4" aria-hidden="true" tabindex="-1"></a>          --parameter-list n 4,10,15,20 <span class="kw">\</span></span>
<span id="benchmark-5"><a href="#benchmark-5" aria-hidden="true" tabindex="-1"></a>          --parameter-list alg bf,bb,dp <span class="kw">\</span></span>
<span id="benchmark-6"><a href="#benchmark-6" aria-hidden="true" tabindex="-1"></a>          --runs 2 <span class="kw">\</span></span>
<span id="benchmark-7"><a href="#benchmark-7" aria-hidden="true" tabindex="-1"></a>          --style color <span class="kw">\</span></span>
<span id="benchmark-8"><a href="#benchmark-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">&#39;cargo run --release -- {alg} &lt; ds/NR{n}_inst.dat&#39;</span> <span class="kw">2&gt;&amp;1</span> <span class="kw">\</span></span>
<span id="benchmark-9"><a href="#benchmark-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span> fold -w 120 -s</span></code></pre></div>
</div>
</div>
</div>
<div class="doctestResult">
<div class="programOutput">
<pre class="ansi2html-content">Linux d5fa4863618d 5.8.0-1042-azure #45~20.04.1-Ubuntu SMP Wed Sep 15 14:24:15 UTC 2021 x86_64 GNU/Linux
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">1</span>: cargo run --release -- bf &lt; ds/NR4_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00"> 99.8 ms</span> ± <span style="color: #00aa00">  1.3 ms</span>    [User: <span style="color: #0000aa">89.4 ms</span>, 
System: <span style="color: #0000aa">10.6 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa"> 98.9 ms</span> … <span style="color: #E850A8">100.8 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">2</span>: cargo run --release -- bf &lt; ds/NR10_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">103.4 ms</span> ± <span style="color: #00aa00">  3.1 ms</span>    [User: <span style="color: #0000aa">93.5 ms</span>, 
System: <span style="color: #0000aa">10.1 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa">101.2 ms</span> … <span style="color: #E850A8">105.6 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">3</span>: cargo run --release -- bf &lt; ds/NR15_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">166.6 ms</span> ± <span style="color: #00aa00"> 10.3 ms</span>    [User: <span style="color: #0000aa">141.1 ms</span>, 
System: <span style="color: #0000aa">23.7 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa">159.4 ms</span> … <span style="color: #E850A8">173.9 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">4</span>: cargo run --release -- bf &lt; ds/NR20_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00"> 1.889 s</span> ± <span style="color: #00aa00"> 0.073 s</span>    [User: <span style="color: #0000aa">1.872 s</span>, 
System: <span style="color: #0000aa">0.016 s</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa"> 1.837 s</span> … <span style="color: #E850A8"> 1.940 s</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">5</span>: cargo run --release -- bb &lt; ds/NR4_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">109.4 ms</span> ± <span style="color: #00aa00"> 10.0 ms</span>    [User: <span style="color: #0000aa">98.8 ms</span>, 
System: <span style="color: #0000aa">10.7 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa">102.4 ms</span> … <span style="color: #E850A8">116.5 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">6</span>: cargo run --release -- bb &lt; ds/NR10_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">105.9 ms</span> ± <span style="color: #00aa00">  3.3 ms</span>    [User: <span style="color: #0000aa">88.1 ms</span>, 
System: <span style="color: #0000aa">17.9 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa">103.6 ms</span> … <span style="color: #E850A8">108.2 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">7</span>: cargo run --release -- bb &lt; ds/NR15_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">164.7 ms</span> ± <span style="color: #00aa00">  0.5 ms</span>    [User: <span style="color: #0000aa">150.8 ms</span>, 
System: <span style="color: #0000aa">14.0 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa">164.4 ms</span> … <span style="color: #E850A8">165.0 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">8</span>: cargo run --release -- bb &lt; ds/NR20_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00"> 2.199 s</span> ± <span style="color: #00aa00"> 0.008 s</span>    [User: <span style="color: #0000aa">2.177 s</span>, 
System: <span style="color: #0000aa">0.018 s</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa"> 2.193 s</span> … <span style="color: #E850A8"> 2.205 s</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">9</span>: cargo run --release -- dp &lt; ds/NR4_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">102.5 ms</span> ± <span style="color: #00aa00">  3.6 ms</span>    [User: <span style="color: #0000aa">94.7 ms</span>, 
System: <span style="color: #0000aa">7.9 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa"> 99.9 ms</span> … <span style="color: #E850A8">105.0 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">10</span>: cargo run --release -- dp &lt; ds/NR10_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">104.9 ms</span> ± <span style="color: #00aa00">  0.2 ms</span>    [User: <span style="color: #0000aa">99.2 ms</span>, 
System: <span style="color: #0000aa">5.8 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa">104.7 ms</span> … <span style="color: #E850A8">105.0 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">11</span>: cargo run --release -- dp &lt; ds/NR15_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">117.5 ms</span> ± <span style="color: #00aa00">  2.8 ms</span>    [User: <span style="color: #0000aa">107.7 ms</span>, 
System: <span style="color: #0000aa">9.9 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa">115.5 ms</span> … <span style="color: #E850A8">119.5 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Benchmark #</span><span style="font-weight: bold">12</span>: cargo run --release -- dp &lt; ds/NR20_inst.dat
  Time (<span style="font-weight: bold; color: #00aa00">mean</span> ± <span style="color: #00aa00">σ</span>):     <span style="font-weight: bold; color: #00aa00">130.3 ms</span> ± <span style="color: #00aa00">  1.6 ms</span>    [User: <span style="color: #0000aa">112.0 ms</span>, 
System: <span style="color: #0000aa">18.4 ms</span>]
  Range (<span style="color: #00aaaa">min</span> … <span style="color: #E850A8">max</span>):   <span style="color: #00aaaa">129.2 ms</span> … <span style="color: #E850A8">131.5 ms</span>    <span style="font-weight: lighter">2 runs</span>
 
<span style="font-weight: bold">Summary</span>
  '<span style="color: #00aaaa">cargo run --release -- bf &lt; ds/NR4_inst.dat</span>' ran
<span style="font-weight: bold; color: #00aa00">    1.03</span> ± <span style="color: #00aa00">0.04</span> times faster than '<span style="color: #E850A8">cargo run --release -- dp &lt; ds/NR4_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">    1.04</span> ± <span style="color: #00aa00">0.03</span> times faster than '<span style="color: #E850A8">cargo run --release -- bf &lt; ds/NR10_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">    1.05</span> ± <span style="color: #00aa00">0.01</span> times faster than '<span style="color: #E850A8">cargo run --release -- dp &lt; ds/NR10_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">    1.06</span> ± <span style="color: #00aa00">0.04</span> times faster than '<span style="color: #E850A8">cargo run --release -- bb &lt; ds/NR10_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">    1.10</span> ± <span style="color: #00aa00">0.10</span> times faster than '<span style="color: #E850A8">cargo run --release -- bb &lt; ds/NR4_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">    1.18</span> ± <span style="color: #00aa00">0.03</span> times faster than '<span style="color: #E850A8">cargo run --release -- dp &lt; ds/NR15_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">    1.31</span> ± <span style="color: #00aa00">0.02</span> times faster than '<span style="color: #E850A8">cargo run --release -- dp &lt; ds/NR20_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">    1.65</span> ± <span style="color: #00aa00">0.02</span> times faster than '<span style="color: #E850A8">cargo run --release -- bb &lt; ds/NR15_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">    1.67</span> ± <span style="color: #00aa00">0.11</span> times faster than '<span style="color: #E850A8">cargo run --release -- bf &lt; ds/NR15_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">   18.92</span> ± <span style="color: #00aa00">0.77</span> times faster than '<span style="color: #E850A8">cargo run --release -- bf &lt; ds/NR20_inst.dat</span>'
<span style="font-weight: bold; color: #00aa00">   22.03</span> ± <span style="color: #00aa00">0.30</span> times faster than '<span style="color: #E850A8">cargo run --release -- bb &lt; ds/NR20_inst.dat</span>'
</pre>
</div>
</div>
</div>
<p>Měření ze spuštění Hyperfine jsou uložena v souboru <code>docs/bench.json</code>, který následně zpracujeme do tabulky níže.</p>
<div class="doctest" data-status="SUCCESS">
<div class="doctestInput">
<div class="fold-block">
<button class="btn btn-outline-primary btn-sm fold-toggle" type="button" data-toggle="collapse" data-target="#json-to-csv-container" aria-controls="json-to-csv-container">&lt;&lt;json-to-csv&gt;&gt;=</button>
<div id="json-to-csv-container" class="collapse">
<div class="sourceCode" id="json-to-csv" style="max-height: 50vh"><pre class="sourceCode zsh eval bootstrap-fold overflow-auto"><code class="sourceCode zsh"><span id="json-to-csv-1"><a href="#json-to-csv-1" aria-hidden="true" tabindex="-1"></a><span class="kw">echo</span> <span class="st">&quot;algoritmus,</span><span class="dt">\$</span><span class="st">n</span><span class="dt">\$</span><span class="st">,průměr,</span><span class="dt">\$</span><span class="st">\pm \sigma</span><span class="dt">\$</span><span class="st">,minimum,medián,maximum&quot;</span> <span class="kw">&gt;</span> docs/bench.csv</span>
<span id="json-to-csv-2"><a href="#json-to-csv-2" aria-hidden="true" tabindex="-1"></a>jq -r <span class="kw">\</span></span>
<span id="json-to-csv-3"><a href="#json-to-csv-3" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;.[] | .[] | [.parameters.alg, .parameters.n</span></span>
<span id="json-to-csv-4"><a href="#json-to-csv-4" aria-hidden="true" tabindex="-1"></a><span class="st">                , ([.mean, .stddev, .min, .median, .max]</span></span>
<span id="json-to-csv-5"><a href="#json-to-csv-5" aria-hidden="true" tabindex="-1"></a><span class="st">                   | map(&quot;**&quot; + (100000 * . + 0.5</span></span>
<span id="json-to-csv-6"><a href="#json-to-csv-6" aria-hidden="true" tabindex="-1"></a><span class="st">                         | floor</span></span>
<span id="json-to-csv-7"><a href="#json-to-csv-7" aria-hidden="true" tabindex="-1"></a><span class="st">                         | . / 100</span></span>
<span id="json-to-csv-8"><a href="#json-to-csv-8" aria-hidden="true" tabindex="-1"></a><span class="st">                         | tostring</span></span>
<span id="json-to-csv-9"><a href="#json-to-csv-9" aria-hidden="true" tabindex="-1"></a><span class="st">                         | if test(&quot;\\.&quot;) then sub(&quot;\\.&quot;; &quot;**.&quot;) else . + &quot;**&quot; end</span></span>
<span id="json-to-csv-10"><a href="#json-to-csv-10" aria-hidden="true" tabindex="-1"></a><span class="st">                         ) + &quot; ms&quot;</span></span>
<span id="json-to-csv-11"><a href="#json-to-csv-11" aria-hidden="true" tabindex="-1"></a><span class="st">                        )</span></span>
<span id="json-to-csv-12"><a href="#json-to-csv-12" aria-hidden="true" tabindex="-1"></a><span class="st">                  )</span></span>
<span id="json-to-csv-13"><a href="#json-to-csv-13" aria-hidden="true" tabindex="-1"></a><span class="st">                ] | flatten | @csv&#39;</span> <span class="kw">\</span></span>
<span id="json-to-csv-14"><a href="#json-to-csv-14" aria-hidden="true" tabindex="-1"></a>   docs/bench.json <span class="kw">\</span></span>
<span id="json-to-csv-15"><a href="#json-to-csv-15" aria-hidden="true" tabindex="-1"></a><span class="kw">&gt;&gt;</span> docs/bench.csv</span>
<span id="json-to-csv-16"><a href="#json-to-csv-16" aria-hidden="true" tabindex="-1"></a><span class="kw">echo</span> <span class="st">&quot;&quot;</span></span></code></pre></div>
</div>
</div>
</div>
<div class="doctestResult">
<div class="programOutput">
<pre class="ansi2html-content">
</pre>
</div>
</div>
</div>
<table style="width:100%;">
<caption>Měření výkonu pro různé kombinace velikosti instancí problému (<span class="math inline">\(n\)</span>) a zvoleného algoritmu. </caption>
<colgroup>
<col style="width: 12%" />
<col style="width: 6%" />
<col style="width: 16%" />
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="header">
<th>algoritmus</th>
<th><span class="math inline">\(n\)</span></th>
<th>průměr</th>
<th><span class="math inline">\(\pm \sigma\)</span></th>
<th>minimum</th>
<th>medián</th>
<th>maximum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>bf</td>
<td>4</td>
<td><strong>99</strong>.84 ms</td>
<td><strong>1</strong>.29 ms</td>
<td><strong>98</strong>.93 ms</td>
<td><strong>99</strong>.84 ms</td>
<td><strong>100</strong>.75 ms</td>
</tr>
<tr class="even">
<td>bf</td>
<td>10</td>
<td><strong>103</strong>.4 ms</td>
<td><strong>3</strong>.09 ms</td>
<td><strong>101</strong>.22 ms</td>
<td><strong>103</strong>.4 ms</td>
<td><strong>105</strong>.59 ms</td>
</tr>
<tr class="odd">
<td>bf</td>
<td>15</td>
<td><strong>166</strong>.62 ms</td>
<td><strong>10</strong>.27 ms</td>
<td><strong>159</strong>.36 ms</td>
<td><strong>166</strong>.62 ms</td>
<td><strong>173</strong>.88 ms</td>
</tr>
<tr class="even">
<td>bf</td>
<td>20</td>
<td><strong>1888</strong>.59 ms</td>
<td><strong>72</strong>.97 ms</td>
<td><strong>1837</strong> ms</td>
<td><strong>1888</strong>.59 ms</td>
<td><strong>1940</strong>.19 ms</td>
</tr>
<tr class="odd">
<td>bb</td>
<td>4</td>
<td><strong>109</strong>.44 ms</td>
<td><strong>9</strong>.98 ms</td>
<td><strong>102</strong>.38 ms</td>
<td><strong>109</strong>.44 ms</td>
<td><strong>116</strong>.49 ms</td>
</tr>
<tr class="even">
<td>bb</td>
<td>10</td>
<td><strong>105</strong>.91 ms</td>
<td><strong>3</strong>.27 ms</td>
<td><strong>103</strong>.59 ms</td>
<td><strong>105</strong>.91 ms</td>
<td><strong>108</strong>.22 ms</td>
</tr>
<tr class="odd">
<td>bb</td>
<td>15</td>
<td><strong>164</strong>.7 ms</td>
<td><strong>0</strong>.45 ms</td>
<td><strong>164</strong>.38 ms</td>
<td><strong>164</strong>.7 ms</td>
<td><strong>165</strong>.02 ms</td>
</tr>
<tr class="even">
<td>bb</td>
<td>20</td>
<td><strong>2199</strong>.06 ms</td>
<td><strong>8</strong>.21 ms</td>
<td><strong>2193</strong>.26 ms</td>
<td><strong>2199</strong>.06 ms</td>
<td><strong>2204</strong>.86 ms</td>
</tr>
<tr class="odd">
<td>dp</td>
<td>4</td>
<td><strong>102</strong>.47 ms</td>
<td><strong>3</strong>.61 ms</td>
<td><strong>99</strong>.92 ms</td>
<td><strong>102</strong>.47 ms</td>
<td><strong>105</strong>.02 ms</td>
</tr>
<tr class="even">
<td>dp</td>
<td>10</td>
<td><strong>104</strong>.86 ms</td>
<td><strong>0</strong>.19 ms</td>
<td><strong>104</strong>.73 ms</td>
<td><strong>104</strong>.86 ms</td>
<td><strong>105</strong> ms</td>
</tr>
<tr class="odd">
<td>dp</td>
<td>15</td>
<td><strong>117</strong>.45 ms</td>
<td><strong>2</strong>.83 ms</td>
<td><strong>115</strong>.45 ms</td>
<td><strong>117</strong>.45 ms</td>
<td><strong>119</strong>.45 ms</td>
</tr>
<tr class="even">
<td>dp</td>
<td>20</td>
<td><strong>130</strong>.34 ms</td>
<td><strong>1</strong>.62 ms</td>
<td><strong>129</strong>.2 ms</td>
<td><strong>130</strong>.34 ms</td>
<td><strong>131</strong>.48 ms</td>
</tr>
</tbody>
</table>
<h3 id="srovnání-algoritmů">Srovnání algoritmů</h3>
<div class="doctest" data-status="SUCCESS">
<div class="doctestInput">
<div class="sourceCode" id="cb1"><pre class="sourceCode python eval"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas.core.tools.numeric <span class="im">import</span> to_numeric</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&quot;docs/bench.csv&quot;</span>, dtype <span class="op">=</span> <span class="st">&quot;string&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df.rename({</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;algoritmus&quot;</span>: <span class="st">&quot;alg&quot;</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;$n$&quot;</span>: <span class="st">&quot;n&quot;</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;průměr&quot;</span>: <span class="st">&quot;avg&quot;</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;$\pm \sigma$&quot;</span>: <span class="st">&quot;sigma&quot;</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;medián&quot;</span>: <span class="st">&quot;median&quot;</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;minimum&quot;</span>: <span class="st">&quot;min&quot;</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;maximum&quot;</span>: <span class="st">&quot;max&quot;</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    inplace <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    errors  <span class="op">=</span> <span class="st">&quot;raise&quot;</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    axis    <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> [<span class="st">&quot;n&quot;</span>, <span class="st">&quot;avg&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;max&quot;</span>]</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>df[numeric_columns] <span class="op">=</span> df[numeric_columns].<span class="bu">apply</span>(<span class="kw">lambda</span> c:</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    c.<span class="bu">apply</span>(<span class="kw">lambda</span> x:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        to_numeric(x.replace(<span class="st">&quot;**&quot;</span>, <span class="st">&quot;&quot;</span>).replace(<span class="st">&quot; ms&quot;</span>, <span class="st">&quot;&quot;</span>))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure and a set of subplots.</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">11</span>, <span class="dv">6</span>))</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> { <span class="st">&quot;bf&quot;</span>: <span class="st">&quot;Hrubá síla&quot;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>         , <span class="st">&quot;bb&quot;</span>: <span class="st">&quot;Branch &amp; bound&quot;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>         , <span class="st">&quot;dp&quot;</span>: <span class="st">&quot;Dynamické programování&quot;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the dataframe by alg and create a line for each group.</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, group <span class="kw">in</span> df.groupby(<span class="st">&quot;alg&quot;</span>):</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    (x, y, sigma) <span class="op">=</span> (group[<span class="st">&quot;n&quot;</span>], group[<span class="st">&quot;avg&quot;</span>], group[<span class="st">&quot;sigma&quot;</span>])</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y, label <span class="op">=</span> labels[name])</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    ax.fill_between(x, y <span class="op">+</span> sigma, y <span class="op">-</span> sigma, alpha <span class="op">=</span> <span class="fl">0.3</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Axis metadata: ticks, scaling, margins, and the legend</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>plt.xticks(df[<span class="st">&quot;n&quot;</span>])</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">&quot;log&quot;</span>, base <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(<span class="bu">list</span>(plt.yticks()[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">list</span>(df[<span class="st">&quot;avg&quot;</span>]), minor <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>ax.margins(<span class="fl">0.05</span>, <span class="fl">0.1</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">&quot;upper left&quot;</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">&quot;docs/graph.svg&quot;</span>)</span></code></pre></div>
</div>
<div class="doctestResult">
<div class="programOutput">
<pre class="ansi2html-content">&lt;Figure size 792x432 with 1 Axes&gt;</pre>
</div>
</div>
</div>
<figure>
<img src="graph.svg" alt="Závislost doby běhu na počtu předmětů. Částečně průhledná oblast značí směrodatnou odchylku (\sigma)." /><figcaption aria-hidden="true">Závislost doby běhu na počtu předmětů. Částečně průhledná oblast značí směrodatnou odchylku (<span class="math inline">\(\sigma\)</span>).</figcaption>
</figure>
<h2 id="implementace">Implementace</h2>
<p>Program začíná definicí datové struktury reprezentující instanci problému batohu.</p>
<div class="annotated-code">
<p><span><em>«problem-instance-definition»=</em></span></p>
<div class="sourceCode" id="problem-instance-definition"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="problem-instance-definition-1"><a href="#problem-instance-definition-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Instance <span class="op">{</span></span>
<span id="problem-instance-definition-2"><a href="#problem-instance-definition-2" aria-hidden="true" tabindex="-1"></a>    id<span class="op">:</span> <span class="dt">i32</span><span class="op">,</span> m<span class="op">:</span> <span class="dt">u32</span><span class="op">,</span> b<span class="op">:</span> <span class="dt">u32</span><span class="op">,</span> items<span class="op">:</span> <span class="dt">Vec</span><span class="op">&lt;</span>(<span class="dt">u32</span><span class="op">,</span> <span class="dt">u32</span>)<span class="op">&gt;</span></span>
<span id="problem-instance-definition-3"><a href="#problem-instance-definition-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div class="annotated-code">
<p><span><em>«solver/src/main.rs»=</em></span></p>
<div class="sourceCode" id="cb2" data-file="solver/src/main.rs"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::</span><span class="op">{</span><span class="pp">io::</span>stdin<span class="op">,</span> <span class="dt">str</span><span class="pp">::</span><span class="bu">FromStr</span><span class="op">};</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">anyhow::</span><span class="op">{</span>Context<span class="op">,</span> <span class="dt">Result</span><span class="op">,</span> anyhow<span class="op">};</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;&lt;</span>problem<span class="op">-</span>instance<span class="op">-</span>definition<span class="op">&gt;&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> alg <span class="op">=</span> <span class="op">{</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;&lt;</span>select<span class="op">-</span>algorithm<span class="op">&gt;&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">loop</span> <span class="op">{</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">match</span> parse_line()<span class="op">?</span> <span class="op">{</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="cn">Some</span>(inst) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;{}&quot;</span><span class="op">,</span> alg(<span class="op">&amp;</span>inst))<span class="op">,</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            <span class="cn">None</span> <span class="op">=&gt;</span> <span class="kw">return</span> <span class="cn">Ok</span>(())</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;&lt;</span>parser<span class="op">&gt;&gt;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="kw">impl</span> Instance <span class="op">{</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;&lt;</span>solver<span class="op">-</span>dp<span class="op">&gt;&gt;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;&lt;</span>solver<span class="op">-</span>bb<span class="op">&gt;&gt;</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;&lt;</span>solver<span class="op">-</span>bf<span class="op">&gt;&gt;</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<h2 id="solvers">Solvers</h2>
<h3 id="brute-force">Brute force</h3>
<div class="annotated-code">
<p><span><em>«solver-bf»=</em></span></p>
<div class="sourceCode" id="solver-bf"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="solver-bf-1"><a href="#solver-bf-1" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> solve_stupider(<span class="op">&amp;</span><span class="kw">self</span>) <span class="op">-&gt;</span> <span class="dt">u32</span> <span class="op">{</span></span>
<span id="solver-bf-2"><a href="#solver-bf-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> (m<span class="op">,</span> b<span class="op">,</span> items) <span class="op">=</span> (<span class="kw">self</span><span class="op">.</span>m<span class="op">,</span> <span class="kw">self</span><span class="op">.</span>b<span class="op">,</span> <span class="op">&amp;</span><span class="kw">self</span><span class="op">.</span>items)<span class="op">;</span></span>
<span id="solver-bf-3"><a href="#solver-bf-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fn</span> go(items<span class="op">:</span> <span class="op">&amp;</span><span class="dt">Vec</span><span class="op">&lt;</span>(<span class="dt">u32</span><span class="op">,</span> <span class="dt">u32</span>)<span class="op">&gt;,</span> cap<span class="op">:</span> <span class="dt">u32</span><span class="op">,</span> i<span class="op">:</span> <span class="dt">usize</span>) <span class="op">-&gt;</span> <span class="dt">u32</span> <span class="op">{</span></span>
<span id="solver-bf-4"><a href="#solver-bf-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">use</span> <span class="pp">std::cmp::</span>max<span class="op">;</span></span>
<span id="solver-bf-5"><a href="#solver-bf-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> i <span class="op">&gt;=</span> items<span class="op">.</span>len() <span class="op">{</span> <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="solver-bf-6"><a href="#solver-bf-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="solver-bf-7"><a href="#solver-bf-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> (w<span class="op">,</span> c) <span class="op">=</span> items[i]<span class="op">;</span></span>
<span id="solver-bf-8"><a href="#solver-bf-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> next <span class="op">=</span> <span class="op">|</span>cap<span class="op">|</span> go(items<span class="op">,</span> cap<span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="solver-bf-9"><a href="#solver-bf-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> include <span class="op">=</span> <span class="op">||</span> next(cap <span class="op">-</span> w)<span class="op">;</span></span>
<span id="solver-bf-10"><a href="#solver-bf-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> exclude <span class="op">=</span> <span class="op">||</span> next(cap)<span class="op">;</span></span>
<span id="solver-bf-11"><a href="#solver-bf-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> current <span class="op">=</span> <span class="kw">if</span> w <span class="op">&lt;=</span> cap <span class="op">{</span></span>
<span id="solver-bf-12"><a href="#solver-bf-12" aria-hidden="true" tabindex="-1"></a>            max(c <span class="op">+</span> include()<span class="op">,</span> exclude())</span>
<span id="solver-bf-13"><a href="#solver-bf-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="solver-bf-14"><a href="#solver-bf-14" aria-hidden="true" tabindex="-1"></a>            exclude()</span>
<span id="solver-bf-15"><a href="#solver-bf-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="solver-bf-16"><a href="#solver-bf-16" aria-hidden="true" tabindex="-1"></a>        current</span>
<span id="solver-bf-17"><a href="#solver-bf-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="solver-bf-18"><a href="#solver-bf-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="solver-bf-19"><a href="#solver-bf-19" aria-hidden="true" tabindex="-1"></a>    go(items<span class="op">,</span> m<span class="op">,</span> <span class="dv">0</span>)</span>
<span id="solver-bf-20"><a href="#solver-bf-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<h3 id="branch-bound">Branch &amp; bound</h3>
<div class="annotated-code">
<p><span><em>«solver-bb»=</em></span></p>
<div class="sourceCode" id="solver-bb"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="solver-bb-1"><a href="#solver-bb-1" aria-hidden="true" tabindex="-1"></a><span class="co">// branch &amp; bound</span></span>
<span id="solver-bb-2"><a href="#solver-bb-2" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> solve_stupid(<span class="op">&amp;</span><span class="kw">self</span>) <span class="op">-&gt;</span> <span class="dt">u32</span> <span class="op">{</span></span>
<span id="solver-bb-3"><a href="#solver-bb-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> (m<span class="op">,</span> b<span class="op">,</span> items) <span class="op">=</span> (<span class="kw">self</span><span class="op">.</span>m<span class="op">,</span> <span class="kw">self</span><span class="op">.</span>b<span class="op">,</span> <span class="op">&amp;</span><span class="kw">self</span><span class="op">.</span>items)<span class="op">;</span></span>
<span id="solver-bb-4"><a href="#solver-bb-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> prices<span class="op">:</span> <span class="dt">Vec</span><span class="op">&lt;</span><span class="dt">u32</span><span class="op">&gt;</span> <span class="op">=</span> items<span class="op">.</span>iter()<span class="op">.</span>rev()</span>
<span id="solver-bb-5"><a href="#solver-bb-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>scan(<span class="dv">0</span><span class="op">,</span> <span class="op">|</span>sum<span class="op">,</span> (_w<span class="op">,</span> c)<span class="op">|</span> <span class="op">{</span></span>
<span id="solver-bb-6"><a href="#solver-bb-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>sum <span class="op">=</span> <span class="op">*</span>sum <span class="op">+</span> c<span class="op">;</span></span>
<span id="solver-bb-7"><a href="#solver-bb-7" aria-hidden="true" tabindex="-1"></a>            <span class="cn">Some</span>(<span class="op">*</span>sum)</span>
<span id="solver-bb-8"><a href="#solver-bb-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span>)</span>
<span id="solver-bb-9"><a href="#solver-bb-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>collect()<span class="op">;</span></span>
<span id="solver-bb-10"><a href="#solver-bb-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fn</span> go(items<span class="op">:</span> <span class="op">&amp;</span><span class="dt">Vec</span><span class="op">&lt;</span>(<span class="dt">u32</span><span class="op">,</span> <span class="dt">u32</span>)<span class="op">&gt;,</span> best<span class="op">:</span> <span class="dt">u32</span><span class="op">,</span> cap<span class="op">:</span> <span class="dt">u32</span><span class="op">,</span> i<span class="op">:</span> <span class="dt">usize</span>) <span class="op">-&gt;</span> <span class="dt">u32</span> <span class="op">{</span></span>
<span id="solver-bb-11"><a href="#solver-bb-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">use</span> <span class="pp">std::cmp::</span>max<span class="op">;</span></span>
<span id="solver-bb-12"><a href="#solver-bb-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> i <span class="op">&gt;=</span> items<span class="op">.</span>len() <span class="op">{</span> <span class="kw">return</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="solver-bb-13"><a href="#solver-bb-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="solver-bb-14"><a href="#solver-bb-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> (w<span class="op">,</span> c) <span class="op">=</span> items[i]<span class="op">;</span></span>
<span id="solver-bb-15"><a href="#solver-bb-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> next <span class="op">=</span> <span class="op">|</span>best<span class="op">,</span> cap<span class="op">|</span> go(items<span class="op">,</span> best<span class="op">,</span> cap<span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="solver-bb-16"><a href="#solver-bb-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> include <span class="op">=</span> <span class="op">||</span> next(best<span class="op">,</span> cap <span class="op">-</span> w)<span class="op">;</span></span>
<span id="solver-bb-17"><a href="#solver-bb-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> exclude <span class="op">=</span> <span class="op">||</span> next(best<span class="op">,</span> cap)<span class="op">;</span></span>
<span id="solver-bb-18"><a href="#solver-bb-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> current <span class="op">=</span> <span class="kw">if</span> w <span class="op">&lt;=</span> cap <span class="op">{</span></span>
<span id="solver-bb-19"><a href="#solver-bb-19" aria-hidden="true" tabindex="-1"></a>            max(c <span class="op">+</span> include()<span class="op">,</span> exclude())</span>
<span id="solver-bb-20"><a href="#solver-bb-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="solver-bb-21"><a href="#solver-bb-21" aria-hidden="true" tabindex="-1"></a>            exclude()</span>
<span id="solver-bb-22"><a href="#solver-bb-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="solver-bb-23"><a href="#solver-bb-23" aria-hidden="true" tabindex="-1"></a>        max(current<span class="op">,</span> best)</span>
<span id="solver-bb-24"><a href="#solver-bb-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="solver-bb-25"><a href="#solver-bb-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="solver-bb-26"><a href="#solver-bb-26" aria-hidden="true" tabindex="-1"></a>    go(items<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> m<span class="op">,</span> <span class="dv">0</span>)</span>
<span id="solver-bb-27"><a href="#solver-bb-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<h3 id="dynamic-programming">Dynamic programming</h3>
<div class="annotated-code">
<p><span><em>«solver-dp»=</em></span></p>
<div class="sourceCode" id="solver-dp"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="solver-dp-1"><a href="#solver-dp-1" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> solve(<span class="op">&amp;</span><span class="kw">self</span>) <span class="op">-&gt;</span> <span class="dt">u32</span> <span class="op">{</span></span>
<span id="solver-dp-2"><a href="#solver-dp-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> (m<span class="op">,</span> b<span class="op">,</span> items) <span class="op">=</span> (<span class="kw">self</span><span class="op">.</span>m<span class="op">,</span> <span class="kw">self</span><span class="op">.</span>b<span class="op">,</span> <span class="op">&amp;</span><span class="kw">self</span><span class="op">.</span>items)<span class="op">;</span></span>
<span id="solver-dp-3"><a href="#solver-dp-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> next <span class="op">=</span> <span class="dt">Vec</span><span class="pp">::</span>with_capacity(m <span class="kw">as</span> <span class="dt">usize</span> <span class="op">+</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="solver-dp-4"><a href="#solver-dp-4" aria-hidden="true" tabindex="-1"></a>    next<span class="op">.</span>resize(m <span class="kw">as</span> <span class="dt">usize</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="solver-dp-5"><a href="#solver-dp-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> last <span class="op">=</span> <span class="dt">Vec</span><span class="pp">::</span>new()<span class="op">;</span></span>
<span id="solver-dp-6"><a href="#solver-dp-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="solver-dp-7"><a href="#solver-dp-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span> i <span class="kw">in</span> <span class="dv">1</span><span class="op">..=</span>items<span class="op">.</span>len() <span class="op">{</span></span>
<span id="solver-dp-8"><a href="#solver-dp-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> (weight<span class="op">,</span> cost) <span class="op">=</span> items[i <span class="op">-</span> <span class="dv">1</span>]<span class="op">;</span></span>
<span id="solver-dp-9"><a href="#solver-dp-9" aria-hidden="true" tabindex="-1"></a>        last<span class="op">.</span>clone_from(<span class="op">&amp;</span>next)<span class="op">;</span></span>
<span id="solver-dp-10"><a href="#solver-dp-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="solver-dp-11"><a href="#solver-dp-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">for</span> cap <span class="kw">in</span> <span class="dv">0</span><span class="op">..=</span>m <span class="kw">as</span> <span class="dt">usize</span> <span class="op">{</span></span>
<span id="solver-dp-12"><a href="#solver-dp-12" aria-hidden="true" tabindex="-1"></a>            next[cap] <span class="op">=</span> <span class="kw">if</span> (cap <span class="kw">as</span> <span class="dt">u32</span>) <span class="op">&lt;</span> weight <span class="op">{</span></span>
<span id="solver-dp-13"><a href="#solver-dp-13" aria-hidden="true" tabindex="-1"></a>                last[cap]</span>
<span id="solver-dp-14"><a href="#solver-dp-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="solver-dp-15"><a href="#solver-dp-15" aria-hidden="true" tabindex="-1"></a>                <span class="kw">use</span> <span class="pp">std::cmp::</span>max<span class="op">;</span></span>
<span id="solver-dp-16"><a href="#solver-dp-16" aria-hidden="true" tabindex="-1"></a>                <span class="kw">let</span> rem_weight <span class="op">=</span> max(<span class="dv">0</span><span class="op">,</span> cap <span class="kw">as</span> <span class="dt">isize</span> <span class="op">-</span> weight <span class="kw">as</span> <span class="dt">isize</span>) <span class="kw">as</span> <span class="dt">usize</span><span class="op">;</span></span>
<span id="solver-dp-17"><a href="#solver-dp-17" aria-hidden="true" tabindex="-1"></a>                max(last[cap]<span class="op">,</span> last[rem_weight] <span class="op">+</span> cost)</span>
<span id="solver-dp-18"><a href="#solver-dp-18" aria-hidden="true" tabindex="-1"></a>            <span class="op">};</span></span>
<span id="solver-dp-19"><a href="#solver-dp-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="solver-dp-20"><a href="#solver-dp-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="solver-dp-21"><a href="#solver-dp-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="solver-dp-22"><a href="#solver-dp-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>next<span class="op">.</span>last()<span class="op">.</span>unwrap() <span class="co">//&gt;= b</span></span>
<span id="solver-dp-23"><a href="#solver-dp-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<h2 id="appendix">Appendix</h2>
<p>Zpracování vstupu neošetřuje chyby ve vstupním formátu,</p>
<div class="fold-block">
<button class="btn btn-outline-primary btn-sm fold-toggle" type="button" data-toggle="collapse" data-target="#parser-container" aria-controls="parser-container">&lt;&lt;parser&gt;&gt;=</button>
<div id="parser-container" class="collapse">
<div class="sourceCode" id="parser" style="max-height: 50vh"><pre class="sourceCode rust bootstrap-fold overflow-auto"><code class="sourceCode rust"><span id="parser-1"><a href="#parser-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;&lt;</span>boilerplate<span class="op">&gt;&gt;</span></span>
<span id="parser-2"><a href="#parser-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="parser-3"><a href="#parser-3" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> parse_line() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span><span class="dt">Option</span><span class="op">&lt;</span>Instance<span class="op">&gt;&gt;</span> <span class="op">{</span></span>
<span id="parser-4"><a href="#parser-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> input <span class="op">=</span> <span class="dt">String</span><span class="pp">::</span>new()<span class="op">;</span></span>
<span id="parser-5"><a href="#parser-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">match</span> stdin()<span class="op">.</span>read_line(<span class="op">&amp;</span><span class="kw">mut</span> input)<span class="op">?</span> <span class="op">{</span></span>
<span id="parser-6"><a href="#parser-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span> <span class="op">=&gt;</span> <span class="kw">return</span> <span class="cn">Ok</span>(<span class="cn">None</span>)<span class="op">,</span></span>
<span id="parser-7"><a href="#parser-7" aria-hidden="true" tabindex="-1"></a>        _ <span class="op">=&gt;</span> ()</span>
<span id="parser-8"><a href="#parser-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="parser-9"><a href="#parser-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="parser-10"><a href="#parser-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> numbers <span class="op">=</span> input<span class="op">.</span>split_whitespace()<span class="op">;</span></span>
<span id="parser-11"><a href="#parser-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> id<span class="op">:</span> <span class="dt">i32</span>   <span class="op">=</span> numbers<span class="op">.</span>parse_next()<span class="op">?;</span></span>
<span id="parser-12"><a href="#parser-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span>  n<span class="op">:</span> <span class="dt">usize</span> <span class="op">=</span> numbers<span class="op">.</span>parse_next()<span class="op">?;</span></span>
<span id="parser-13"><a href="#parser-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span>  m<span class="op">:</span> <span class="dt">u32</span>   <span class="op">=</span> numbers<span class="op">.</span>parse_next()<span class="op">?;</span></span>
<span id="parser-14"><a href="#parser-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span>  b<span class="op">:</span> <span class="dt">u32</span>   <span class="op">=</span> numbers<span class="op">.</span>parse_next()<span class="op">?;</span></span>
<span id="parser-15"><a href="#parser-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="parser-16"><a href="#parser-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> items<span class="op">:</span> <span class="dt">Vec</span><span class="op">&lt;</span>(<span class="dt">u32</span><span class="op">,</span> <span class="dt">u32</span>)<span class="op">&gt;</span> <span class="op">=</span> <span class="dt">Vec</span><span class="pp">::</span>with_capacity(n)<span class="op">;</span></span>
<span id="parser-17"><a href="#parser-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span> _ <span class="kw">in</span> <span class="dv">0</span><span class="op">..</span>n <span class="op">{</span></span>
<span id="parser-18"><a href="#parser-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> w <span class="op">=</span> numbers<span class="op">.</span>parse_next()<span class="op">?;</span></span>
<span id="parser-19"><a href="#parser-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> c <span class="op">=</span> numbers<span class="op">.</span>parse_next()<span class="op">?;</span></span>
<span id="parser-20"><a href="#parser-20" aria-hidden="true" tabindex="-1"></a>        items<span class="op">.</span>push((w<span class="op">,</span> c))<span class="op">;</span></span>
<span id="parser-21"><a href="#parser-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="parser-22"><a href="#parser-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="parser-23"><a href="#parser-23" aria-hidden="true" tabindex="-1"></a>    <span class="cn">Ok</span>(<span class="cn">Some</span>(Instance <span class="op">{</span>id<span class="op">,</span> m<span class="op">,</span> b<span class="op">,</span> items<span class="op">}</span>))</span>
<span id="parser-24"><a href="#parser-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
<p>Výběr algoritmu je řízen argumentem předaným na příkazové řádce. Příslušnou funkci vrátíme jako hodnotu tohoto bloku:</p>
<div class="fold-block">
<button class="btn btn-outline-primary btn-sm fold-toggle" type="button" data-toggle="collapse" data-target="#select-algorithm-container" aria-controls="select-algorithm-container">&lt;&lt;select-algorithm&gt;&gt;=</button>
<div id="select-algorithm-container" class="collapse">
<div class="sourceCode" id="select-algorithm" style="max-height: 50vh"><pre class="sourceCode rust bootstrap-fold overflow-auto"><code class="sourceCode rust"><span id="select-algorithm-1"><a href="#select-algorithm-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::</span>env<span class="op">;</span></span>
<span id="select-algorithm-2"><a href="#select-algorithm-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> args<span class="op">:</span> <span class="dt">Vec</span><span class="op">&lt;</span><span class="dt">String</span><span class="op">&gt;</span> <span class="op">=</span> <span class="pp">env::</span>args()<span class="op">.</span>collect()<span class="op">;</span></span>
<span id="select-algorithm-3"><a href="#select-algorithm-3" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> args<span class="op">.</span>len() <span class="op">!=</span> <span class="dv">2</span> <span class="op">{</span></span>
<span id="select-algorithm-4"><a href="#select-algorithm-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(</span>
<span id="select-algorithm-5"><a href="#select-algorithm-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Usage: {} &lt;algorithm&gt;, where &lt;algorithm&gt; is one of bf, bb, dp&quot;</span><span class="op">,</span></span>
<span id="select-algorithm-6"><a href="#select-algorithm-6" aria-hidden="true" tabindex="-1"></a>        args[<span class="dv">0</span>]</span>
<span id="select-algorithm-7"><a href="#select-algorithm-7" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="select-algorithm-8"><a href="#select-algorithm-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="cn">Err</span>(<span class="pp">anyhow!</span>(<span class="st">&quot;Expected 1 argument, got {}&quot;</span><span class="op">,</span> args<span class="op">.</span>len() <span class="op">-</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="select-algorithm-9"><a href="#select-algorithm-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="select-algorithm-10"><a href="#select-algorithm-10" aria-hidden="true" tabindex="-1"></a><span class="kw">match</span> <span class="op">&amp;</span>args[<span class="dv">1</span>][<span class="op">..</span>] <span class="op">{</span></span>
<span id="select-algorithm-11"><a href="#select-algorithm-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;bf&quot;</span>    <span class="op">=&gt;</span> <span class="pp">Instance::</span>solve_stupider<span class="op">,</span></span>
<span id="select-algorithm-12"><a href="#select-algorithm-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;bb&quot;</span>    <span class="op">=&gt;</span> <span class="pp">Instance::</span>solve_stupid<span class="op">,</span></span>
<span id="select-algorithm-13"><a href="#select-algorithm-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;dp&quot;</span>    <span class="op">=&gt;</span> <span class="pp">Instance::</span>solve<span class="op">,</span></span>
<span id="select-algorithm-14"><a href="#select-algorithm-14" aria-hidden="true" tabindex="-1"></a>    invalid <span class="op">=&gt;</span> <span class="pp">panic!</span>(<span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">{}</span><span class="sc">\&quot;</span><span class="st"> is not a known algorithm&quot;</span><span class="op">,</span> invalid)<span class="op">,</span></span>
<span id="select-algorithm-15"><a href="#select-algorithm-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
<p>Trait <code>Boilerplate</code> definuje funkci <code>parse_next</code> pro zkrácení zápisu zpracování vstupu.</p>
<div class="fold-block">
<button class="btn btn-outline-primary btn-sm fold-toggle" type="button" data-toggle="collapse" data-target="#boilerplate-container" aria-controls="boilerplate-container">&lt;&lt;boilerplate&gt;&gt;=</button>
<div id="boilerplate-container" class="collapse">
<div class="sourceCode" id="boilerplate" style="max-height: 50vh"><pre class="sourceCode rust bootstrap-fold overflow-auto"><code class="sourceCode rust"><span id="boilerplate-1"><a href="#boilerplate-1" aria-hidden="true" tabindex="-1"></a><span class="kw">trait</span> Boilerplate <span class="op">{</span></span>
<span id="boilerplate-2"><a href="#boilerplate-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fn</span> parse_next<span class="op">&lt;</span>T<span class="op">:</span> <span class="bu">FromStr</span><span class="op">&gt;</span>(<span class="op">&amp;</span><span class="kw">mut</span> <span class="kw">self</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="boilerplate-3"><a href="#boilerplate-3" aria-hidden="true" tabindex="-1"></a>      <span class="kw">where</span> <span class="op">&lt;</span>T <span class="kw">as</span> <span class="bu">FromStr</span><span class="op">&gt;</span><span class="pp">::</span><span class="cn">Err</span><span class="op">:</span> <span class="pp">std::error::</span><span class="bu">Error</span> <span class="op">+</span> <span class="bu">Send</span> <span class="op">+</span> <span class="bu">Sync</span> <span class="op">+</span> <span class="ot">&#39;static</span><span class="op">;</span></span>
<span id="boilerplate-4"><a href="#boilerplate-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="boilerplate-5"><a href="#boilerplate-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="boilerplate-6"><a href="#boilerplate-6" aria-hidden="true" tabindex="-1"></a><span class="kw">impl</span> Boilerplate <span class="kw">for</span> <span class="pp">std::</span><span class="dt">str</span><span class="pp">::</span>SplitWhitespace<span class="op">&lt;</span><span class="ot">&#39;_</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="boilerplate-7"><a href="#boilerplate-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fn</span> parse_next<span class="op">&lt;</span>T<span class="op">:</span> <span class="bu">FromStr</span><span class="op">&gt;</span>(<span class="op">&amp;</span><span class="kw">mut</span> <span class="kw">self</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>T<span class="op">&gt;</span></span>
<span id="boilerplate-8"><a href="#boilerplate-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">where</span> <span class="op">&lt;</span>T <span class="kw">as</span> <span class="bu">FromStr</span><span class="op">&gt;</span><span class="pp">::</span><span class="cn">Err</span><span class="op">:</span> <span class="pp">std::error::</span><span class="bu">Error</span> <span class="op">+</span> <span class="bu">Send</span> <span class="op">+</span> <span class="bu">Sync</span> <span class="op">+</span> <span class="ot">&#39;static</span> <span class="op">{</span></span>
<span id="boilerplate-9"><a href="#boilerplate-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> <span class="dt">str</span> <span class="op">=</span> <span class="kw">self</span><span class="op">.</span>next()<span class="op">.</span>ok_or(<span class="pp">anyhow!</span>(<span class="st">&quot;unexpected end of input&quot;</span>))<span class="op">?;</span></span>
<span id="boilerplate-10"><a href="#boilerplate-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">str</span><span class="op">.</span><span class="pp">parse::</span><span class="op">&lt;</span>T<span class="op">&gt;</span>()</span>
<span id="boilerplate-11"><a href="#boilerplate-11" aria-hidden="true" tabindex="-1"></a>           <span class="op">.</span>with_context(<span class="op">||</span> <span class="pp">format!</span>(<span class="st">&quot;cannot parse {}&quot;</span><span class="op">,</span> <span class="dt">str</span>))</span>
<span id="boilerplate-12"><a href="#boilerplate-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="boilerplate-13"><a href="#boilerplate-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div></main>



<!-- Bootstrap 4.5.0 -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

<!-- Mathjax -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
